This algorithm was copied from https://github.com/cs-au-dk/TAJS
Some minor changes were made to extract the output slightly easier.
(which can be found in Monitoring.java.diff)

